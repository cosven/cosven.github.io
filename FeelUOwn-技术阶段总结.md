title: FeelUOwn 技术阶段总结
date: 2015-07-07 15:17:33
tags: [pyqt, python3]
categories: summary
---

## FeelUOwn 简介
FeelUOwn 是一款基于PyQt5的音乐播放器为Linux环境设计开发的音乐播放器。

它的最终目标不仅仅是提供简单的音乐服务。我们做的不仅仅是把软件从windows或者mac上迁移过来，我们会提供一些有趣的，提升biger的东西。

1. 我们的初步目标会大概的满足音乐需求。（这个基本目标任何时候都不会改变）
2. 接着，我们会提供一些有趣或者炫酷的功能。下面提到的程序架构设计部分就是专门考虑了这个目标，比如说 `webkit` 的引入。

有趣，比如说智能把音乐和豆瓣音乐、豆瓣电影匹配。写音乐笔记 等等
炫酷，比如说 数据可视化, 把你每天听音乐的时间，种类进行可视化 -- blabla 的。（个人想象能力有限嘛）这里有一些网站可以参考。 <http://d3js.org/>

** 这些不是空谈，它是有意义，而且技术可行。所以无论你想玩想玩软件开发，或者数据处理，大家都可以来一起玩玩 **

<!-- more -->

项目主页：<http://www.cosven.com/FeelUOwn>

闲话不多说，下面直接来总结回顾在这个项目的架构和一些技术


### 程序架构

FeelUOwn 采用MVC架构，

网络模块用`requests`库简单的包装了一个web类

> 视图模块主要定义了界面的布局，还有widgets的样式，大小。
另外，视图模块里面定义了一些功能稍微复杂的组件，放在widgets文件夹中。这些组件它既定义了自己的样式，也有自己的一些固定的方法（也就是说，这些组件包含了本应该放在 controller 的东西，感觉这事以后需要的地方）。

> 数据模块定义了各种数据的一个标准模型。这个模块暂时的主要作用就是规定一个数据对象有哪些键值。比如说一首music，它就最少会有id, title, artist等这几个字段。

> 控制模块主要包括UI逻辑控制，数据处理，任务调度。

> 程序中还有一个webkit部分，它会和controller进行数据交互，执行逻辑由controller控制。webkit部分有自己的样式，有自己内部的数据处理和交互控制。感觉算是一个单独的小模块。

为了快速的开发, 现在的视图模块和数据模块都比较简单。不过我也考虑了以后修改，应该会比较方便。

控制模块稍微复杂了点。下面来回忆下控制模块。


### controller 模块

controller 模块主要包含几个小模块。

1. `webview模块`， 包含了webkit部分接口管理，和逻辑控制。
2. `api模块` 提供统一的访问音乐资源的接口。
3. `plugin模块` 一些与平台（音乐平台，系统平台）具体相关的功能模块。比如说，某个功能只能在ubuntu上使用，那这个模块就应该放在这个地方。还有一些`特效或者神奇功能模块`，可以考虑放在这里。
4. `theme控制模块`, 利用 qss 进行主题切换等。
5. `播放器模块` 音乐的播放控制

controller模块有一个控制中心，也就是 `controller.py` 的MainWidget类。

 
控制中心可以直接管控其他模块。

** 其他模块怎样通信呢？ **
目前，其他模块如果想要通信，一般来说都通过传递信号的方法，先传给控制中心，再传递给目标。


** 程序的并发主要基于 `asyncio` 这个框架。 **

** 程序的网络请求模块基于requests库。

** 音乐播放由 QMediaPlayer 来掌控 **

** mv，视屏播放调用外部播放器完成 **

** webview 依赖qt的webkit ** 


#### 项目结构

##### src 目录下的东西

** base 目录 **

> 提供一些基本共用的工具，从它们的名字都可以看出作用。

```
├── base
│   ├── __init__.py
│   ├── __pycache__
│   ├── common.py
│   ├── logger.py
│   ├── models.py
│   ├── network_manger.py
│   ├── player.py
│   └── web.py
```

** widgets 目录 **

> 提供功能稍微复杂，自己定制的widget。

```
└── widgets
    ├── __pycache__
    ├── js_interface.py
    ├── login_dialog.py
    ├── lyric_widget.py
    ├── music_table_widget.py
    ├── playlist_widget.py
    ├── trayicon.py
    └── webview.py
```

** themes 目录 **

> 提供主题，以后可能要把图标等一些资源也放到这里

** web_assets **

跟webview有关的东西基本都在这里

** plugin 目录 **

一些插件


##### 非 src 目录

非src目录下的东西就没什么好说的了，从名字基本可以看出来它存在的意义。
